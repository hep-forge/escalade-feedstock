{% set versions = {
    "HEAD": "latest",
    "v9.08.26": "b13f3bb4d4c9ac2ebd6c805ab9f153ea9a317d32"
} %}

{% set version = environ.get('COMMIT_VERSION', None) %}
{% set version = version or versions.keys()|first %}
{% set version = version|string %}

{% set libtorch = libtorch if libtorch else "0" %}
{% set root = root if root else "0" %}

build:
  number: 0
  string: "torch{{ libtorch.replace('.', '') }}_root{{ root.replace('.', '') }}"
  ignore_run_exports_from:
    - tbb
    - tbb-devel

package:
  name: {{ environ.get('ANACONDA_PACKAGE', "escalade")|string|lower }}
  version: {{ environ.get('ANACONDA_VERSION', version)|replace("-", ".") }}

source:
  git_url: "https://git.ligo.org/kagra/libraries-addons/root/root-plus"
  git_rev: {{ version }}

requirements:
  build:
    - {{ compiler('cxx') }} # [linux]
    - {{ compiler('c') }}   # [linux]
    - {{ stdlib('c') }}

    - cmake
    - make

  host:
    - root-plus
    - mpi
    - hdf5

  run:
    - root-plus
    - gettext
    - bc
    - coreutils
    - mpi
    - hdf5

about:
  home: "https://git.ligo.org/kagra/libraries-addons/root/root-plus"
  license: "GPL-3.0"
  summary: "ROOT+ for Tensor Calculation & Advanced Signal Processing"
  description: |
    ROOT+ is an Open-Source library implementing complex tensor calculation, advanced signal processing. It can be used for scientific Machine Learning developments in C/C++"

extra:
  recipe-maintainers:
    - meiyasan
